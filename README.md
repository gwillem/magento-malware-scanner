[![Build Status](https://travis-ci.org/gwillem/magento-malware-collection.svg?branch=master)](https://travis-ci.org/gwillem/magento-malware-collection)

# Magento Malware Collection

![small germ](https://buq.eu/img/small-germ.jpg)

A collection of frontend and backend malware found in the wild on Magento sites.

Purpose: demonstrate ingeniuity of cyber thieves

Secondary purpose: help administrators to automatically detect and disarm malware on their systems.

# Context

For our free [MageReport](https://www.magereport.com) service we've already been collecting malware samples to aid in fingerprint development and detecting compromised sites. Now, many responsible hosting providers and system administrators are doing the same work. That's incredibly inefficient. 

Goal:

> Once a particular strain of malware has been found and analyzed, nobody should have to duplicate these efforts.

Yes, there are many other projects to share malware signatures. However, as 2016 has become the Year of Magento Malware, I 
feel there's a significant edge to focus solely on Magento malware. This permits certain assumptions on the codebase. For example, new signatures can be validated against all Magento releases and all extensions ever published.
That doesn't mean that you should not implement other malware collections in your scans. 

Maintaining malware databases is hard. It's all about standardization, low submission barriers, automated test procedures. I hope this effort saves somebody some valuable time.

Contributions most welcome.

# Howto

```bash
# Install prerequisites on Debian/Ubuntu flavoured server
sudo apt install yara python3

# Checkout repository. 
git clone git@github.com:gwillem/magento-malware-collection.git
cd magento-malware-collection

# Run scan on webroot
yara -r rules/all-confirmed.yar /var/www

# Run tests to validate signatures and samples
python tools/runtests.py
```

